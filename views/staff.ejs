<% 
    // Function to add ordinal suffix to the day
    const addOrdinalSuffix = (day) => {
    if (day >= 11 && day <= 13) {
        return day + 'th';
    } else {
        switch (day % 10) {
        case 1: return day + 'st';
        case 2: return day + 'nd';
        case 3: return day + 'rd';
        default: return day + 'th';
        }
    }
    };
%>

<%- include('./partials/header.ejs') %>

<body>
    <%- include('./partials/banner.ejs') %>
    <%- include('./partials/nav-staff.ejs') %>

    <div class="products mt-16">
        <div class="product">
            <h3 class="text-3xl font-semibold py-2">Upcoming Shifts</h3>
            <div class="overflow-y-auto max-h-[21rem]">
                <% for (const i in shiftData){ %>
                    <% 
                        const startDateString = shiftData[i].Start_Time;
                        const startTime = new Date(startDateString).toLocaleTimeString([], { hour12:false })

                        const startDate = new Date(startDateString);
                        const dayOfMonth = addOrdinalSuffix(startDate.getDate());
                        const month = startDate.toLocaleString('en-UK', { month: 'long'} );
                        const dayOfWeek = startDate.toLocaleString('en-UK', { weekday: 'long'} );
                        const formattedDate = `${dayOfWeek}, ${dayOfMonth} ${month}`;

                        const endDateString = shiftData[i].End_Time;
                        const endTime = new Date(endDateString).toLocaleTimeString([], { hour12:false });
                    %>
                    <div class="py-1 border-t border-black shift">
                        <h4 class="text-xl font-medium"><%= formattedDate %></h4>
                        <p><%= startTime %> - <%= endTime %></p>
                    </div>
                <% } %>
            </div>
        </div>

        <div class="product">
            <h3 class="text-3xl font-semibold py-2 border-b border-black">My Tasks</h3>
            <div class="overflow-y-auto max-h-72">
                <ol class="my-4 text-left px-8 list-decimal">
                    <li>Restock shelves in aisle 3</li>
                    <li>Inventory check in warehouse</li>
                    <li>Assist customers in Electronics Department</li>
                </ol>
            </div>
        </div>

        <% for (const i in stockData){ %>
            <div class="product">
                <img src="<%= stockData[i].ImageLink %>" alt="Product image" class="w-full h-56 object-cover">
                <h4 class="font-medium text-lg mt-4"><%= stockData[i].Name %></h4>
                <p class="mt-2">Current Stock: <span class="font-medium <%= stockData[i].Count >= 20 ? 'text-green-500':'text-red-500' %>"><%= stockData[i].Count %></span> Units</p>
                <p class="mt-2">Restock Threshold: <span class="font-medium">20</span> Units</p>
                <button type="" class="btn btn-primary mt-6 w-full !rounded-none">Restock</button>
            </div>
        <% } %>
    </div>

<%- include('./partials/footer.ejs') %>